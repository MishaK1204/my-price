<!-- Categories Carousel -->
@if (!loading() && categories().length > 0) {
  <section class="home-section categories-section">
    <my-price-carousel>
      @for (cat of categories(); track cat.key) {
        <my-price-category-item
          [data]="cat"
          [selected]="false"
          (select)="onSelectCategory($event)"
        ></my-price-category-item>
      }
    </my-price-carousel>
  </section>
}

<!-- Stores Carousel -->
@if (!loading() && stores().length > 0) {
  <section class="home-section stores-section">
    <my-price-carousel [autoScroll]="true" [autoScrollInterval]="5000">
      @for (store of stores(); track store.key) {
        <my-price-store-item
          [data]="store"
          [selected]="false"
          (click)="onSelectStore(store.key)"
        ></my-price-store-item>
      }
    </my-price-carousel>
  </section>
}

<!-- Product List -->
<section class="home-section">
  <div class="section-header">
    <h2>პროდუქტები</h2>
  </div>

  @if (productsLoading()) {
    <div class="home-loading">
      <div class="spinner"></div>
      <p>იტვირთება...</p>
    </div>
  }

  @if (!productsLoading() && storeData().length > 0) {
    <div class="stores-container">
      @for (item of storeData(); track item.title) {
        <div class="store-section">
          <div class="store-header">
            <div class="store-header-left">
              @if (item.imageUrl) {
                <img [src]="item.imageUrl" [alt]="item.title" class="store-logo" />
              }
              <h3 class="store-title">{{ item.title }}</h3>
            </div>
            @if (item.products && item.products.length > 8) {
              <button class="see-all-button" (click)="onSeeAll(item.source)">
                ყველას ნახვა
              </button>
            }
          </div>

          @if (item.products && item.products.length > 0) {
            <div class="store-products-grid">
              @for (product of item.products.slice(0, 4); track product.url) {
                <my-price-product-item
                  [product]="product"
                  [store]="item"
                ></my-price-product-item>
              }
            </div>
          }
        </div>
      }
    </div>
  }

  @if (!productsLoading() && storeData().length === 0) {
    <div class="home-empty">
      <p>პროდუქტები არ მოიძებნა</p>
    </div>
  }
</section>

@if (showScrollToTop()) {
  <button class="scroll-to-top-button" (click)="scrollToTop()" aria-label="Scroll to top">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M5 15L12 8L19 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </button>
}